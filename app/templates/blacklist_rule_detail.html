{% extends "base.html" %}
{% block content %}
<div class="container mx-auto p-6 bg-white rounded-lg shadow-lg my-8 max-w-2xl">
    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Blacklist Rule Details (ID: {{ rule.id }})</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
        <div class="bg-gray-50 p-4 rounded-md">
            <p class="text-gray-600"><strong>Sequence:</strong> <span class="font-semibold text-gray-800">{{ rule.sequence }}</span></p>
            <p class="text-gray-600"><strong>Rule Name:</strong> <span class="font-semibold text-gray-800">{{ rule.rule_name }}</span></p>
            <p class="text-gray-600"><strong>Enabled:</strong> <span class="font-semibold text-gray-800">{{ 'Yes' if rule.enabled else 'No' }}</span></p>
            <p class="text-gray-600"><strong>Source IP:</strong> <span class="font-semibold text-gray-800">{{ rule.source_ip if rule.source_ip else 'Any' }}</span></p>
            <p class="text-gray-600"><strong>Destination IP:</strong> <span class="font-semibold text-gray-800">{{ rule.destination_ip if rule.destination_ip else 'Any' }}</span></p>
            <p class="text-gray-600"><strong>Protocol:</strong> <span class="font-semibold text-gray-800">{{ rule.protocol if rule.protocol else 'Any' }}</span></p>
            <p class="text-gray-600"><strong>Port:</strong> <span class="font-semibold text-gray-800">{{ rule.destination_port if rule.destination_port else 'Any' }}</span></p>
            <p class="text-gray-600"><strong>Description:</strong> <span class="text-gray-800">{{ rule.description if rule.description else 'N/A' }}</span></p>
        </div>
        <div class="bg-gray-50 p-4 rounded-md">
            <p class="text-gray-600"><strong>Created At:</strong> <span id="created_at_display" class="font-semibold text-gray-800" data-utc-timestamp="{{ created_at_utc }}">{{ rule.created_at.strftime('%Y-%m-%d %H:%M:%S UTC') if rule.created_at else 'N/A' }}</span></p>
            <p class="text-gray-600">
                <strong>Created By:</strong>
                <span class="font-semibold text-gray-800">
                    {% if rule.creator %}
                        {{ rule.creator.username }}
                    {% else %}
                        N/A (User Deleted or Unknown)
                    {% endif %}
                </span>
            </p>
            <p class="text-gray-600"><strong>Last Updated:</strong> <span id="updated_at_display" class="font-semibold text-gray-800" data-utc-timestamp="{{ updated_at_utc }}">{{ rule.updated_at.strftime('%Y-%m-%d %H:%M:%S UTC') if rule.updated_at else 'N/A' }}</span></p>
            <p class="text-gray-600">
                <strong>Last Updated By:</strong>
                <span class="font-semibold text-gray-800">
                    {% if rule.editor %}
                        {{ rule.editor.username }}
                    {% else %}
                        N/A (User Deleted or Unknown)
                    {% endif %}
                </span>
            </p>
        </div>
    </div>

    <div class="flex justify-center mt-8 space-x-4">
        <a href="{{ url_for('routes.blacklist_rules_list') }}" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105">‚Üê Back to Blacklist Rules</a>
        <a href="{{ url_for('routes.edit_blacklist_rule', rule_id=rule.id) }}" class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105">Edit Rule</a>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const timestampElements = [
            { id: 'created_at_display', utc_timestamp: '{{ created_at_utc }}' },
            { id: 'updated_at_display', utc_timestamp: '{{ updated_at_utc }}' }
        ];

        timestampElements.forEach(item => {
            const element = document.getElementById(item.id);
            const utcTimestampString = item.utc_timestamp;

            if (element && utcTimestampString && utcTimestampString !== 'None') {
                try {
                    const date = new Date(utcTimestampString);

                    const options = {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: false // Use 24-hour format
                    };
                    element.textContent = date.toLocaleString('en-GB', options);
                } catch (e) {
                    console.error('Error parsing date:', e);
                    element.textContent = 'Invalid Date';
                }
            } else if (element) {
                element.textContent = 'N/A';
            }
        });
    });
</script>
{% endblock %}
