2025-06-27 00:03:53,450 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:03:53,451 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:03:53,803 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:03:53,803 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:03:54,210 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:03:54,210 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:03:56,288 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:03:56,288 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:03:58,576 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:03:58,576 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:03:58,604 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:03:58,604 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:03:58,640 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:03:58,640 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:04:11,327 - app.routes - INFO - Received new network request from approver2
2025-06-27 00:04:11,330 - app.routes - INFO - Request from 10.0.1.1 to 10.3.1.10:7071/tcp passed blacklist check for user approver2.
2025-06-27 00:04:11,335 - app.routes - INFO - Network request ID 1 created by approver2 with temporary status 'Pending Pre-Check'.
2025-06-27 00:04:11,335 - app.routes - WARNING - NetworkAutomationService not found on blueprint. Creating a fallback instance.
2025-06-27 00:04:11,335 - app.services.network_automation - INFO - Ansible outputs directory set to: /home/firework/firework/app/services/../../outputs
2025-06-27 00:04:11,335 - app.services.network_automation - INFO - Ansible temporary directory set to: /home/firework/firework/app/services/../../ansible_tmp
2025-06-27 00:04:11,335 - app.services.network_automation - INFO - Performing pre-check for rule 1 on firewalls initially specified: ['pa_firewall_1', 'fgt_firewall_1', 'fgt_firewall_2']
2025-06-27 00:04:11,335 - app.services.network_automation - INFO - Running Ansible network data collector (collector.yml)...
2025-06-27 00:04:11,335 - app.services.network_automation - DEBUG - --- Subprocess Environment for Ansible ---
2025-06-27 00:04:11,335 - app.services.network_automation - DEBUG -   PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
2025-06-27 00:04:11,335 - app.services.network_automation - DEBUG -   USER=firework_app_user
2025-06-27 00:04:11,335 - app.services.network_automation - DEBUG -   HOME=/home/firework_app_user
2025-06-27 00:04:11,335 - app.services.network_automation - DEBUG -   ANSIBLE_CACHE_DIR=/home/firework/firework/app/services/../../ansible_tmp/cache
2025-06-27 00:04:11,335 - app.services.network_automation - DEBUG -   ANSIBLE_TMPDIR=/home/firework/firework/app/services/../../ansible_tmp
2025-06-27 00:04:11,335 - app.services.network_automation - DEBUG -   ANSIBLE_HOST_KEY_CHECKING=False
2025-06-27 00:04:11,335 - app.services.network_automation - DEBUG -   ANSIBLE_COLLECTIONS_PATH=/home/firework/firework/app/services/../.././ansible_collections
2025-06-27 00:04:11,335 - app.services.network_automation - DEBUG -   TMPDIR=/home/firework/firework/app/services/../../ansible_tmp
2025-06-27 00:04:11,336 - app.services.network_automation - DEBUG - ----------------------------------------
2025-06-27 00:04:11,336 - app.services.network_automation - INFO - Executing Ansible command: ansible-playbook /home/firework/firework/app/services/../.././collector.yml -i /home/firework/firework/app/services/../../inventory.yml in CWD: /home/firework/firework/app/services/../..
2025-06-27 00:04:39,016 - app.services.network_automation - INFO - Ansible playbook 'collector.yml' executed successfully.
2025-06-27 00:04:39,016 - app.services.network_automation - INFO - Network data collection completed.
2025-06-27 00:04:39,016 - app.services.network_automation - INFO - Starting network topology database build process in PostgreSQL.
2025-06-27 00:04:39,016 - app.services.network_automation - INFO - Attempting to list directory: /home/firework/firework/app/services/../../outputs
2025-06-27 00:04:39,016 - app.services.network_automation - INFO - Files found in /home/firework/firework/app/services/../../outputs: ['R1_interfaces.yml', 'R1_routes.txt', 'fgt_arp.yml', 'R2_interfaces.yml', 'R1_arp.txt', 'SW1_interfaces.yml', 'R2_routes.txt', 'SW1_arp.txt', 'fgt_routes.yml', 'R3_routes.txt', 'R2_arp.txt', 'SW1_routes.txt', 'pafw_arp.txt', 'R3_interfaces.yml', 'fgt_interfaces.yml', 'R3_arp.txt', 'pafw_routes.txt', 'pafw_interfaces.yml']
2025-06-27 00:04:39,021 - app.services.network_automation - INFO - Cleared existing network topology data from PostgreSQL.
2025-06-27 00:04:39,021 - app.services.network_automation - DEBUG - Identified file: R1_interfaces.yml -> Hostname: R1, Category: interfaces
2025-06-27 00:04:39,021 - app.services.network_automation - DEBUG - Identified file: R1_routes.txt -> Hostname: R1, Category: routes
2025-06-27 00:04:39,021 - app.services.network_automation - DEBUG - Identified file: fgt_arp.yml -> Hostname: fgt, Category: arp
2025-06-27 00:04:39,021 - app.services.network_automation - DEBUG - Identified file: R2_interfaces.yml -> Hostname: R2, Category: interfaces
2025-06-27 00:04:39,021 - app.services.network_automation - DEBUG - Identified file: R1_arp.txt -> Hostname: R1, Category: arp
2025-06-27 00:04:39,021 - app.services.network_automation - DEBUG - Identified file: SW1_interfaces.yml -> Hostname: SW1, Category: interfaces
2025-06-27 00:04:39,021 - app.services.network_automation - DEBUG - Identified file: R2_routes.txt -> Hostname: R2, Category: routes
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: SW1_arp.txt -> Hostname: SW1, Category: arp
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: fgt_routes.yml -> Hostname: fgt, Category: routes
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: R3_routes.txt -> Hostname: R3, Category: routes
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: R2_arp.txt -> Hostname: R2, Category: arp
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: SW1_routes.txt -> Hostname: SW1, Category: routes
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: pafw_arp.txt -> Hostname: pafw, Category: arp
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: R3_interfaces.yml -> Hostname: R3, Category: interfaces
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: fgt_interfaces.yml -> Hostname: fgt, Category: interfaces
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: R3_arp.txt -> Hostname: R3, Category: arp
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: pafw_routes.txt -> Hostname: pafw, Category: routes
2025-06-27 00:04:39,022 - app.services.network_automation - DEBUG - Identified file: pafw_interfaces.yml -> Hostname: pafw, Category: interfaces
2025-06-27 00:04:39,022 - app.services.network_automation - INFO - Discovered device files for processing: {
  "R1": {
    "type": "Router",
    "interfaces": "/home/firework/firework/app/services/../../outputs/R1_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/R1_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/R1_routes.txt"
  },
  "fgt": {
    "type": "Firewall",
    "interfaces": "/home/firework/firework/app/services/../../outputs/fgt_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/fgt_arp.yml",
    "routes": "/home/firework/firework/app/services/../../outputs/fgt_routes.yml"
  },
  "R2": {
    "type": "Router",
    "interfaces": "/home/firework/firework/app/services/../../outputs/R2_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/R2_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/R2_routes.txt"
  },
  "SW1": {
    "type": "Switch",
    "interfaces": "/home/firework/firework/app/services/../../outputs/SW1_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/SW1_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/SW1_routes.txt"
  },
  "R3": {
    "type": "Router",
    "interfaces": "/home/firework/firework/app/services/../../outputs/R3_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/R3_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/R3_routes.txt"
  },
  "pafw": {
    "type": "Firewall",
    "interfaces": "/home/firework/firework/app/services/../../outputs/pafw_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/pafw_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/pafw_routes.txt"
  }
}
2025-06-27 00:04:39,023 - app.services.network_automation - INFO - Attempting to process data for device: R1
2025-06-27 00:04:39,027 - app.services.network_automation - INFO - Added new device 'R1' (ID: 1) to session.
2025-06-27 00:04:39,027 - app.services.network_automation - INFO - Processing interfaces for R1 from /home/firework/firework/app/services/../../outputs/R1_interfaces.yml
2025-06-27 00:04:39,127 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R1_interfaces.yml' size: 2123 bytes.
2025-06-27 00:04:39,128 - app.services.network_automation - DEBUG - Raw content of /home/firework/firework/app/services/../../outputs/R1_interfaces.yml:
ansible_net_all_ipv4_addresses:
- 10.11.0.1
- 10.0.1.254
- 10.0.2.254
- 10.250.10.111
ansible_net_all_ipv6_addresses: []
ansible_net_api: cliconf
ansible_net_gather_network_resources: []
ansible_net_gather_subset:
- default
- interfaces
ansible_net_hostname: R1
ansible_net_image: flash0:/vios-adventerprisek9-m
ansible_net_interfaces:
    GigabitEthernet0/0:
        bandwidth: 1000000
        description: '*** pafw ***'
        duplex: null
        ipv4:
        -   address: 10.11.0.1
           ...
2025-06-27 00:04:39,134 - app.services.network_automation - DEBUG - Parsed interface data for R1: {
  "ansible_net_all_ipv4_addresses": [
    "10.11.0.1",
    "10.0.1.254",
    "10.0.2.254",
    "10.250.10.111"
  ],
  "ansible_net_all_ipv6_addresses": [],
  "ansible_net_api": "cliconf",
  "ansible_net_gather_network_resources": [],
  "ansible_net_gather_subset": [
    "default",
    "interfaces"
  ],
  "ansible_net_hostname": "R1",
  "ansible_net_image": "flash0:/vios-adventerprisek9-m",
  "ansible_net_interfaces": {
    "GigabitEthernet0/0": {
      "bandwidth": 1000000,
      "description": "*** pafw ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.11.0.1",
          "subnet": "30"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c0d.f8a2.0000",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/1": {
      "bandwidth": 1000000,
      "description": "*** s0 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.0.1.254",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c0d.f8a2.0001",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/2": {
      "bandwidth": 1000000,
      "description": "*** d0 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.0.2.254",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c0d.f8a2.0002",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/3": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [
        {
          "address": "10.250.10.111",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c0d.f8a2.0003",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "NVI0": {
      "bandwidth": 56,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "up",
      "macaddress": null,
      "mediatype": null,
      "mtu": 1514,
      "operstatus": "up",
      "type": null
    }
  },
  "ansible_net_iostype": "IOS",
  "ansible_net_model": "IOSv",
  "ansible_net_neighbors": {},
  "ansible_net_operatingmode": "autonomous",
  "ansible_net_python_version": "3.12.3",
  "ansible_net_serialnum": "9MQLLMAY42N2TTAMWTLXE",
  "ansible_net_system": "ios",
  "ansible_net_version": "15.6(2)T",
  "ansible_network_resources": {}
}
2025-06-27 00:04:39,135 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/0' details for R1. Details: {"bandwidth": 1000000, "description": "*** pafw ***", "duplex": null, "ipv4": [{"address": "10.11.0.1", "subnet": "30"}], "lineprotocol": "up", "macaddress": "0c0d.f8a2.0000", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:39,135 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/0: 10.11.0.0/30
2025-06-27 00:04:39,135 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/0' (10.11.0.1) for R1 to session.
2025-06-27 00:04:39,135 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/1' details for R1. Details: {"bandwidth": 1000000, "description": "*** s0 ***", "duplex": null, "ipv4": [{"address": "10.0.1.254", "subnet": "24"}], "lineprotocol": "up", "macaddress": "0c0d.f8a2.0001", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:39,135 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/1: 10.0.1.0/24
2025-06-27 00:04:39,135 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/1' (10.0.1.254) for R1 to session.
2025-06-27 00:04:39,136 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/2' details for R1. Details: {"bandwidth": 1000000, "description": "*** d0 ***", "duplex": null, "ipv4": [{"address": "10.0.2.254", "subnet": "24"}], "lineprotocol": "up", "macaddress": "0c0d.f8a2.0002", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:39,136 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/2: 10.0.2.0/24
2025-06-27 00:04:39,136 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/2' (10.0.2.254) for R1 to session.
2025-06-27 00:04:39,136 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/3' details for R1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [{"address": "10.250.10.111", "subnet": "24"}], "lineprotocol": "up", "macaddress": "0c0d.f8a2.0003", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:39,136 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/3: 10.250.10.0/24
2025-06-27 00:04:39,136 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/3' (10.250.10.111) for R1 to session.
2025-06-27 00:04:39,136 - app.services.network_automation - DEBUG - Parsing interface 'NVI0' details for R1. Details: {"bandwidth": 56, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "up", "macaddress": null, "mediatype": null, "mtu": 1514, "operstatus": "up", "type": null}
2025-06-27 00:04:39,136 - app.services.network_automation - INFO - Finished adding 4 interfaces for R1.
2025-06-27 00:04:39,136 - app.services.network_automation - INFO - Processing ARP for R1 from /home/firework/firework/app/services/../../outputs/R1_arp.txt
2025-06-27 00:04:39,237 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R1_arp.txt' size: 630 bytes.
2025-06-27 00:04:39,237 - app.services.network_automation - DEBUG - Raw ARP data for R1:
Protocol  Address          Age (min)  Hardware Addr   Type   Interface
Internet  10.0.1.254              -   0c0d.f8a2.0001  ARPA   GigabitEthernet0/1
Internet  10.0.2.254              -   0c0d.f8a2.0002  ARPA   GigabitEthernet0/2
Internet  10.11.0.1               -   0c0d.f8a2.0000  ARPA   GigabitEthernet0/0
Internet  10.11.0.2              29   0ccd.9ded.0001  ARPA   GigabitEthernet0/0
Internet  10.250.10.1             0   000c.2930.4f3a  ARPA   GigabitEthernet0/3
Internet  10.250.10.111      ...
2025-06-27 00:04:39,237 - app.services.network_automation - INFO - Added ARP entry 10.0.1.254 (0c0df8a20001) on R1 to session.
2025-06-27 00:04:39,237 - app.services.network_automation - INFO - Added ARP entry 10.0.2.254 (0c0df8a20002) on R1 to session.
2025-06-27 00:04:39,237 - app.services.network_automation - INFO - Added ARP entry 10.11.0.1 (0c0df8a20000) on R1 to session.
2025-06-27 00:04:39,237 - app.services.network_automation - INFO - Added ARP entry 10.11.0.2 (0ccd9ded0001) on R1 to session.
2025-06-27 00:04:39,237 - app.services.network_automation - INFO - Added ARP entry 10.250.10.1 (000c29304f3a) on R1 to session.
2025-06-27 00:04:39,237 - app.services.network_automation - INFO - Added ARP entry 10.250.10.111 (0c0df8a20003) on R1 to session.
2025-06-27 00:04:39,237 - app.services.network_automation - INFO - Added ARP entry 10.250.10.206 (000c29a0559f) on R1 to session.
2025-06-27 00:04:39,237 - app.services.network_automation - INFO - Finished adding 7 ARP entries for R1.
2025-06-27 00:04:39,238 - app.services.network_automation - INFO - Processing routes for R1 from /home/firework/firework/app/services/../../outputs/R1_routes.txt
2025-06-27 00:04:39,338 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R1_routes.txt' size: 1805 bytes.
2025-06-27 00:04:39,338 - app.services.network_automation - DEBUG - Raw Route data for R1:
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area 
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2
       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
       ia - IS-IS inter area, * - candidate default, U - per-user static route
       o - ODR, P - periodic downloaded static route, H - NHRP, l - L...
2025-06-27 00:04:39,338 - app.services.network_automation - INFO - Added route 0.0.0.0/0 via 10.250.10.1 on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.0.1.0/24 via None on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.0.1.254/32 via None on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.0.2.0/24 via None on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.0.2.254/32 via None on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.1.1.0/24 via 10.11.0.2 on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.2.1.0/24 via 10.11.0.2 on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.3.1.0/24 via 10.11.0.2 on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.11.0.0/30 via None on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.11.0.1/32 via None on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.12.0.0/30 via 10.11.0.2 on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.21.0.0/30 via 10.11.0.2 on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.31.0.0/30 via 10.11.0.2 on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.123.0.0/24 via 10.11.0.2 on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.250.10.0/24 via None on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Added route 10.250.10.111/32 via None on R1 to session.
2025-06-27 00:04:39,339 - app.services.network_automation - INFO - Finished adding 16 route entries for R1.
2025-06-27 00:04:39,346 - app.services.network_automation - INFO - Successfully committed data for device: R1
2025-06-27 00:04:39,346 - app.services.network_automation - INFO - Attempting to process data for device: fgt
2025-06-27 00:04:39,348 - app.services.network_automation - INFO - Added new device 'fgt' (ID: 2) to session.
2025-06-27 00:04:39,348 - app.services.network_automation - INFO - Processing interfaces for fgt from /home/firework/firework/app/services/../../outputs/fgt_interfaces.yml
2025-06-27 00:04:39,448 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/fgt_interfaces.yml' size: 1481 bytes.
2025-06-27 00:04:39,448 - app.services.network_automation - DEBUG - Raw content of /home/firework/firework/app/services/../../outputs/fgt_interfaces.yml:
changed: false
failed: false
meta:
    build: 2795
    http_method: GET
    name: interface
    path: system
    results:
        port1:
            alias: (mgmt)
            duplex: 1
            id: port1
            ip: 10.250.10.101
            link: true
            mac: 00:0c:29:c7:98:ad
            mask: 24
            name: port1
            rx_bytes: 43613066
            rx_errors: 0
            rx_packets: 200988
            speed: 10000.0
            tx_bytes: 33269931
            tx_...
2025-06-27 00:04:39,450 - app.services.network_automation - DEBUG - Parsed interface data for fgt: {
  "changed": false,
  "failed": false,
  "meta": {
    "build": 2795,
    "http_method": "GET",
    "name": "interface",
    "path": "system",
    "results": {
      "port1": {
        "alias": "(mgmt)",
        "duplex": 1,
        "id": "port1",
        "ip": "10.250.10.101",
        "link": true,
        "mac": "00:0c:29:c7:98:ad",
        "mask": 24,
        "name": "port1",
        "rx_bytes": 43613066,
        "rx_errors": 0,
        "rx_packets": 200988,
        "speed": 10000.0,
        "tx_bytes": 33269931,
        "tx_errors": 0,
        "tx_packets": 231939
      },
      "port2": {
        "alias": "(dmz)",
        "duplex": 1,
        "id": "port2",
        "ip": "10.2.1.254",
        "link": true,
        "mac": "00:0c:29:c7:98:b7",
        "mask": 24,
        "name": "port2",
        "rx_bytes": 2949098,
        "rx_errors": 0,
        "rx_packets": 36415,
        "speed": 10000.0,
        "tx_bytes": 3688724,
        "tx_errors": 0,
        "tx_packets": 41132
      },
      "port3": {
        "alias": "(lan)",
        "duplex": 1,
        "id": "port3",
        "ip": "10.123.0.2",
        "link": true,
        "mac": "00:0c:29:c7:98:c1",
        "mask": 24,
        "name": "port3",
        "rx_bytes": 2916986,
        "rx_errors": 0,
        "rx_packets": 36283,
        "speed": 10000.0,
        "tx_bytes": 3732792,
        "tx_errors": 0,
        "tx_packets": 41412
      }
    },
    "revision": "1750971865.849539",
    "serial": "FGVMEVHSU6ZDYQ0D",
    "status": "success",
    "vdom": "root",
    "version": "v7.4.8"
  }
}
2025-06-27 00:04:39,450 - app.services.network_automation - INFO - Finished adding 0 interfaces for fgt.
2025-06-27 00:04:39,450 - app.services.network_automation - INFO - Processing ARP for fgt from /home/firework/firework/app/services/../../outputs/fgt_arp.yml
2025-06-27 00:04:39,551 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/fgt_arp.yml' size: 492 bytes.
2025-06-27 00:04:39,551 - app.services.network_automation - DEBUG - Raw ARP data for fgt:
changed: false
failed: false
meta:
    build: 2795
    http_method: GET
    name: arp
    path: network
    results:
    -   age: 0
        interface: port1
        ip: 10.250.10.206
        mac: 00:0c:29:a0:55:9f
    -   age: 18125
        interface: port3
        ip: 10.123.0.1
        mac: 0c:a9:e8:e5:00:02
    -   age: 17
        interface: port1
        ip: 10.250.10.1
        mac: 00:0c:29:30:4f:3a
    serial: FGVMEVHSU6ZDYQ0D
    status: success
    vdom: root
    version: v7.4.8...
2025-06-27 00:04:39,552 - app.services.network_automation - INFO - Finished adding 0 ARP entries for fgt.
2025-06-27 00:04:39,552 - app.services.network_automation - INFO - Processing routes for fgt from /home/firework/firework/app/services/../../outputs/fgt_routes.yml
2025-06-27 00:04:39,652 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/fgt_routes.yml' size: 3596 bytes.
2025-06-27 00:04:39,652 - app.services.network_automation - DEBUG - Raw Route data for fgt:
changed: false
failed: false
meta:
    build: 2795
    http_method: GET
    name: ipv4
    path: router
    results:
    -   distance: 10
        gateway: 10.250.10.1
        interface: port1
        ip_mask: 0.0.0.0/0
        ip_version: 4
        metric: 0
        non_rc_gateway: 10.250.10.1
        origin: unspecified
        priority: 1
        type: static
        vrf: 0
    -   distance: 110
        gateway: 10.123.0.1
        install_date: 1750953926
        interface: port3
        ip_ma...
2025-06-27 00:04:39,657 - app.services.network_automation - INFO - Finished adding 0 route entries for fgt.
2025-06-27 00:04:39,672 - app.services.network_automation - INFO - Successfully committed data for device: fgt
2025-06-27 00:04:39,672 - app.services.network_automation - INFO - Attempting to process data for device: R2
2025-06-27 00:04:39,673 - app.services.network_automation - INFO - Added new device 'R2' (ID: 3) to session.
2025-06-27 00:04:39,673 - app.services.network_automation - INFO - Processing interfaces for R2 from /home/firework/firework/app/services/../../outputs/R2_interfaces.yml
2025-06-27 00:04:39,773 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R2_interfaces.yml' size: 1959 bytes.
2025-06-27 00:04:39,773 - app.services.network_automation - DEBUG - Raw content of /home/firework/firework/app/services/../../outputs/R2_interfaces.yml:
ansible_net_all_ipv4_addresses:
- 10.12.0.2
- 10.21.0.1
- 10.250.10.112
ansible_net_all_ipv6_addresses: []
ansible_net_api: cliconf
ansible_net_gather_network_resources: []
ansible_net_gather_subset:
- default
- interfaces
ansible_net_hostname: R2
ansible_net_image: flash0:/vios-adventerprisek9-m
ansible_net_interfaces:
    GigabitEthernet0/0:
        bandwidth: 1000000
        description: '*** pafw ***'
        duplex: null
        ipv4:
        -   address: 10.12.0.2
            subnet: '30'
...
2025-06-27 00:04:39,776 - app.services.network_automation - DEBUG - Parsed interface data for R2: {
  "ansible_net_all_ipv4_addresses": [
    "10.12.0.2",
    "10.21.0.1",
    "10.250.10.112"
  ],
  "ansible_net_all_ipv6_addresses": [],
  "ansible_net_api": "cliconf",
  "ansible_net_gather_network_resources": [],
  "ansible_net_gather_subset": [
    "default",
    "interfaces"
  ],
  "ansible_net_hostname": "R2",
  "ansible_net_image": "flash0:/vios-adventerprisek9-m",
  "ansible_net_interfaces": {
    "GigabitEthernet0/0": {
      "bandwidth": 1000000,
      "description": "*** pafw ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.12.0.2",
          "subnet": "30"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0cfa.c987.0000",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/1": {
      "bandwidth": 1000000,
      "description": "*** SW1 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.21.0.1",
          "subnet": "30"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0cfa.c987.0001",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/2": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [
        {
          "address": "10.250.10.112",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0cfa.c987.0002",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/3": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": "Auto",
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0cfa.c987.0003",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "administratively down",
      "type": "iGbE"
    }
  },
  "ansible_net_iostype": "IOS",
  "ansible_net_model": "IOSv",
  "ansible_net_neighbors": {
    "GigabitEthernet0/1": [
      {
        "host": "SW1",
        "ip": "10.21.0.2",
        "platform": "Cisco ",
        "port": "GigabitEthernet0/0"
      }
    ]
  },
  "ansible_net_operatingmode": "autonomous",
  "ansible_net_python_version": "3.12.3",
  "ansible_net_serialnum": "9A6U2IL5ECVYHRE68IG6J",
  "ansible_net_system": "ios",
  "ansible_net_version": "15.6(2)T",
  "ansible_network_resources": {}
}
2025-06-27 00:04:39,776 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/0' details for R2. Details: {"bandwidth": 1000000, "description": "*** pafw ***", "duplex": null, "ipv4": [{"address": "10.12.0.2", "subnet": "30"}], "lineprotocol": "up", "macaddress": "0cfa.c987.0000", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:39,776 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/0: 10.12.0.0/30
2025-06-27 00:04:39,776 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/0' (10.12.0.2) for R2 to session.
2025-06-27 00:04:39,776 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/1' details for R2. Details: {"bandwidth": 1000000, "description": "*** SW1 ***", "duplex": null, "ipv4": [{"address": "10.21.0.1", "subnet": "30"}], "lineprotocol": "up", "macaddress": "0cfa.c987.0001", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:39,776 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/1: 10.21.0.0/30
2025-06-27 00:04:39,776 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/1' (10.21.0.1) for R2 to session.
2025-06-27 00:04:39,776 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/2' details for R2. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [{"address": "10.250.10.112", "subnet": "24"}], "lineprotocol": "up", "macaddress": "0cfa.c987.0002", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:39,776 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/2: 10.250.10.0/24
2025-06-27 00:04:39,776 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/2' (10.250.10.112) for R2 to session.
2025-06-27 00:04:39,776 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/3' details for R2. Details: {"bandwidth": 1000000, "description": null, "duplex": "Auto", "ipv4": [], "lineprotocol": "down", "macaddress": "0cfa.c987.0003", "mediatype": "RJ45", "mtu": 1500, "operstatus": "administratively down", "type": "iGbE"}
2025-06-27 00:04:39,776 - app.services.network_automation - INFO - Finished adding 3 interfaces for R2.
2025-06-27 00:04:39,776 - app.services.network_automation - INFO - Processing ARP for R2 from /home/firework/firework/app/services/../../outputs/R2_arp.txt
2025-06-27 00:04:39,877 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R2_arp.txt' size: 630 bytes.
2025-06-27 00:04:39,877 - app.services.network_automation - DEBUG - Raw ARP data for R2:
Protocol  Address          Age (min)  Hardware Addr   Type   Interface
Internet  10.12.0.1              29   0ccd.9ded.0002  ARPA   GigabitEthernet0/0
Internet  10.12.0.2               -   0cfa.c987.0000  ARPA   GigabitEthernet0/0
Internet  10.21.0.1               -   0cfa.c987.0001  ARPA   GigabitEthernet0/1
Internet  10.21.0.2              60   0ca9.e8e5.0000  ARPA   GigabitEthernet0/1
Internet  10.250.10.1           187   000c.2930.4f3a  ARPA   GigabitEthernet0/2
Internet  10.250.10.112      ...
2025-06-27 00:04:39,877 - app.services.network_automation - INFO - Added ARP entry 10.12.0.1 (0ccd9ded0002) on R2 to session.
2025-06-27 00:04:39,877 - app.services.network_automation - INFO - Added ARP entry 10.12.0.2 (0cfac9870000) on R2 to session.
2025-06-27 00:04:39,877 - app.services.network_automation - INFO - Added ARP entry 10.21.0.1 (0cfac9870001) on R2 to session.
2025-06-27 00:04:39,877 - app.services.network_automation - INFO - Added ARP entry 10.21.0.2 (0ca9e8e50000) on R2 to session.
2025-06-27 00:04:39,877 - app.services.network_automation - INFO - Added ARP entry 10.250.10.1 (000c29304f3a) on R2 to session.
2025-06-27 00:04:39,877 - app.services.network_automation - INFO - Added ARP entry 10.250.10.112 (0cfac9870002) on R2 to session.
2025-06-27 00:04:39,877 - app.services.network_automation - INFO - Added ARP entry 10.250.10.206 (000c29a0559f) on R2 to session.
2025-06-27 00:04:39,877 - app.services.network_automation - INFO - Finished adding 7 ARP entries for R2.
2025-06-27 00:04:39,877 - app.services.network_automation - INFO - Processing routes for R2 from /home/firework/firework/app/services/../../outputs/R2_routes.txt
2025-06-27 00:04:39,977 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R2_routes.txt' size: 1746 bytes.
2025-06-27 00:04:39,978 - app.services.network_automation - DEBUG - Raw Route data for R2:
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area 
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2
       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
       ia - IS-IS inter area, * - candidate default, U - per-user static route
       o - ODR, P - periodic downloaded static route, H - NHRP, l - L...
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 0.0.0.0/0 via 10.250.10.1 on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.0.1.0/24 via 10.12.0.1 on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.0.2.0/24 via 10.12.0.1 on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.1.1.0/24 via 10.12.0.1 on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.2.1.0/24 via 10.21.0.2 on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.3.1.0/24 via 10.21.0.2 on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.11.0.0/30 via 10.12.0.1 on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.12.0.0/30 via None on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.12.0.2/32 via None on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.21.0.0/30 via None on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.21.0.1/32 via None on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.31.0.0/30 via 10.21.0.2 on R2 to session.
2025-06-27 00:04:39,978 - app.services.network_automation - INFO - Added route 10.123.0.0/24 via 10.21.0.2 on R2 to session.
2025-06-27 00:04:39,979 - app.services.network_automation - INFO - Added route 10.250.10.0/24 via None on R2 to session.
2025-06-27 00:04:39,979 - app.services.network_automation - INFO - Added route 10.250.10.112/32 via None on R2 to session.
2025-06-27 00:04:39,979 - app.services.network_automation - INFO - Finished adding 15 route entries for R2.
2025-06-27 00:04:39,982 - app.services.network_automation - INFO - Successfully committed data for device: R2
2025-06-27 00:04:39,982 - app.services.network_automation - INFO - Attempting to process data for device: SW1
2025-06-27 00:04:39,983 - app.services.network_automation - INFO - Added new device 'SW1' (ID: 4) to session.
2025-06-27 00:04:39,983 - app.services.network_automation - INFO - Processing interfaces for SW1 from /home/firework/firework/app/services/../../outputs/SW1_interfaces.yml
2025-06-27 00:04:40,084 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/SW1_interfaces.yml' size: 5850 bytes.
2025-06-27 00:04:40,084 - app.services.network_automation - DEBUG - Raw content of /home/firework/firework/app/services/../../outputs/SW1_interfaces.yml:
ansible_net_all_ipv4_addresses:
- 10.123.0.1
- 10.31.0.1
- 10.21.0.2
- 10.250.10.110
ansible_net_all_ipv6_addresses: []
ansible_net_api: cliconf
ansible_net_gather_network_resources: []
ansible_net_gather_subset:
- default
- interfaces
ansible_net_hostname: SW1
ansible_net_image: flash0:/vios_l2-adventerprisek9-m
ansible_net_interfaces:
    GigabitEthernet0/0:
        bandwidth: 1000000
        description: '*** R2 ***'
        duplex: null
        ipv4:
        -   address: 10.21.0.2
          ...
2025-06-27 00:04:40,091 - app.services.network_automation - DEBUG - Parsed interface data for SW1: {
  "ansible_net_all_ipv4_addresses": [
    "10.123.0.1",
    "10.31.0.1",
    "10.21.0.2",
    "10.250.10.110"
  ],
  "ansible_net_all_ipv6_addresses": [],
  "ansible_net_api": "cliconf",
  "ansible_net_gather_network_resources": [],
  "ansible_net_gather_subset": [
    "default",
    "interfaces"
  ],
  "ansible_net_hostname": "SW1",
  "ansible_net_image": "flash0:/vios_l2-adventerprisek9-m",
  "ansible_net_interfaces": {
    "GigabitEthernet0/0": {
      "bandwidth": 1000000,
      "description": "*** R2 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.21.0.2",
          "subnet": "30"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0ca9.e8e5.0000",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "up",
      "type": "GigabitEthernet"
    },
    "GigabitEthernet0/1": {
      "bandwidth": 1000000,
      "description": "*** R3 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.31.0.1",
          "subnet": "30"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0ca9.e8e5.0001",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "up",
      "type": "GigabitEthernet"
    },
    "GigabitEthernet0/2": {
      "bandwidth": 1000000,
      "description": "*** fgt port3 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.123.0.1",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0ca9.e8e5.0002",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "up",
      "type": "GigabitEthernet"
    },
    "GigabitEthernet0/3": {
      "bandwidth": 1000000,
      "description": "*** d2 ***",
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "up",
      "macaddress": "0ca9.e8e5.0003",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet1/0": {
      "bandwidth": 1000000,
      "description": "*** mgmt ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.250.10.110",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0ca9.e8e5.0004",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "up",
      "type": "GigabitEthernet"
    },
    "GigabitEthernet1/1": {
      "bandwidth": 1000000,
      "description": "*** fgt port2 ***",
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "up",
      "macaddress": "0ca9.e8e5.0005",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet1/2": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.0006",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    },
    "GigabitEthernet1/3": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.0007",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    },
    "GigabitEthernet2/0": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.0008",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    },
    "GigabitEthernet2/1": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.0009",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    },
    "GigabitEthernet2/2": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.000a",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    },
    "GigabitEthernet2/3": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.000b",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    },
    "GigabitEthernet3/0": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.000c",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    },
    "GigabitEthernet3/1": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.000d",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    },
    "GigabitEthernet3/2": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.000e",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    },
    "GigabitEthernet3/3": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0ca9.e8e5.000f",
      "mediatype": "unknown media type",
      "mtu": 1500,
      "operstatus": "down",
      "type": "iGbE"
    }
  },
  "ansible_net_iostype": "IOS",
  "ansible_net_model": "IOSv",
  "ansible_net_neighbors": {
    "GigabitEthernet0/0": [
      {
        "host": "R2",
        "ip": "10.21.0.1",
        "platform": "Cisco ",
        "port": "GigabitEthernet0/1"
      }
    ],
    "GigabitEthernet0/1": [
      {
        "host": "R3.firework.dev",
        "ip": "10.31.0.2",
        "platform": "Cisco ",
        "port": "GigabitEthernet0/0"
      }
    ],
    "GigabitEthernet0/2": [
      {
        "host": "SW1",
        "ip": "10.123.0.1",
        "platform": "Cisco ",
        "port": "GigabitEthernet1/1"
      }
    ],
    "GigabitEthernet1/1": [
      {
        "host": "SW1",
        "ip": "10.123.0.1",
        "platform": "Cisco ",
        "port": "GigabitEthernet0/2"
      }
    ]
  },
  "ansible_net_operatingmode": "autonomous",
  "ansible_net_python_version": "3.12.3",
  "ansible_net_serialnum": "9OTZET338D3",
  "ansible_net_system": "ios",
  "ansible_net_version": "15.2(4.0.55)E",
  "ansible_network_resources": {}
}
2025-06-27 00:04:40,091 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/0' details for SW1. Details: {"bandwidth": 1000000, "description": "*** R2 ***", "duplex": null, "ipv4": [{"address": "10.21.0.2", "subnet": "30"}], "lineprotocol": "up", "macaddress": "0ca9.e8e5.0000", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "up", "type": "GigabitEthernet"}
2025-06-27 00:04:40,091 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/0: 10.21.0.0/30
2025-06-27 00:04:40,092 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/0' (10.21.0.2) for SW1 to session.
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/1' details for SW1. Details: {"bandwidth": 1000000, "description": "*** R3 ***", "duplex": null, "ipv4": [{"address": "10.31.0.1", "subnet": "30"}], "lineprotocol": "up", "macaddress": "0ca9.e8e5.0001", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "up", "type": "GigabitEthernet"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/1: 10.31.0.0/30
2025-06-27 00:04:40,092 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/1' (10.31.0.1) for SW1 to session.
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/2' details for SW1. Details: {"bandwidth": 1000000, "description": "*** fgt port3 ***", "duplex": null, "ipv4": [{"address": "10.123.0.1", "subnet": "24"}], "lineprotocol": "up", "macaddress": "0ca9.e8e5.0002", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "up", "type": "GigabitEthernet"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/2: 10.123.0.0/24
2025-06-27 00:04:40,092 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/2' (10.123.0.1) for SW1 to session.
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/3' details for SW1. Details: {"bandwidth": 1000000, "description": "*** d2 ***", "duplex": null, "ipv4": [], "lineprotocol": "up", "macaddress": "0ca9.e8e5.0003", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet1/0' details for SW1. Details: {"bandwidth": 1000000, "description": "*** mgmt ***", "duplex": null, "ipv4": [{"address": "10.250.10.110", "subnet": "24"}], "lineprotocol": "up", "macaddress": "0ca9.e8e5.0004", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "up", "type": "GigabitEthernet"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet1/0: 10.250.10.0/24
2025-06-27 00:04:40,092 - app.services.network_automation - INFO - Added interface 'GigabitEthernet1/0' (10.250.10.110) for SW1 to session.
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet1/1' details for SW1. Details: {"bandwidth": 1000000, "description": "*** fgt port2 ***", "duplex": null, "ipv4": [], "lineprotocol": "up", "macaddress": "0ca9.e8e5.0005", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet1/2' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.0006", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet1/3' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.0007", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet2/0' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.0008", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet2/1' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.0009", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet2/2' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.000a", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet2/3' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.000b", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet3/0' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.000c", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet3/1' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.000d", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet3/2' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.000e", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet3/3' details for SW1. Details: {"bandwidth": 1000000, "description": null, "duplex": null, "ipv4": [], "lineprotocol": "down", "macaddress": "0ca9.e8e5.000f", "mediatype": "unknown media type", "mtu": 1500, "operstatus": "down", "type": "iGbE"}
2025-06-27 00:04:40,092 - app.services.network_automation - INFO - Finished adding 4 interfaces for SW1.
2025-06-27 00:04:40,092 - app.services.network_automation - INFO - Processing ARP for SW1 from /home/firework/firework/app/services/../../outputs/SW1_arp.txt
2025-06-27 00:04:40,193 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/SW1_arp.txt' size: 1190 bytes.
2025-06-27 00:04:40,193 - app.services.network_automation - DEBUG - Raw ARP data for SW1:
Protocol  Address          Age (min)  Hardware Addr   Type   Interface
Internet  10.21.0.1              60   0cfa.c987.0001  ARPA   GigabitEthernet0/0
Internet  10.21.0.2               -   0ca9.e8e5.0000  ARPA   GigabitEthernet0/0
Internet  10.31.0.1               -   0ca9.e8e5.0001  ARPA   GigabitEthernet0/1
Internet  10.31.0.2              59   0c42.50d8.0000  ARPA   GigabitEthernet0/1
Internet  10.123.0.1              -   0ca9.e8e5.0002  ARPA   GigabitEthernet0/2
Internet  10.123.0.2         ...
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.21.0.1 (0cfac9870001) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.21.0.2 (0ca9e8e50000) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.31.0.1 (0ca9e8e50001) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.31.0.2 (0c4250d80000) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.123.0.1 (0ca9e8e50002) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.123.0.2 (000c29c798c1) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.250.10.1 (000c29304f3a) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.250.10.110 (0ca9e8e50004) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.250.10.111 (0c0df8a20003) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.250.10.112 (0cfac9870002) on SW1 to session.
2025-06-27 00:04:40,193 - app.services.network_automation - INFO - Added ARP entry 10.250.10.113 (0c4250d80002) on SW1 to session.
2025-06-27 00:04:40,194 - app.services.network_automation - INFO - Added ARP entry 10.250.10.161 (0ccd9ded0000) on SW1 to session.
2025-06-27 00:04:40,194 - app.services.network_automation - INFO - Added ARP entry 10.250.10.204 (000c29066a46) on SW1 to session.
2025-06-27 00:04:40,194 - app.services.network_automation - INFO - Added ARP entry 10.250.10.206 (000c29a0559f) on SW1 to session.
2025-06-27 00:04:40,194 - app.services.network_automation - INFO - Finished adding 14 ARP entries for SW1.
2025-06-27 00:04:40,194 - app.services.network_automation - INFO - Processing routes for SW1 from /home/firework/firework/app/services/../../outputs/SW1_routes.txt
2025-06-27 00:04:40,294 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/SW1_routes.txt' size: 1778 bytes.
2025-06-27 00:04:40,294 - app.services.network_automation - DEBUG - Raw Route data for SW1:
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area 
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2
       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
       ia - IS-IS inter area, * - candidate default, U - per-user static route
       o - ODR, P - periodic downloaded static route, H - NHRP, l - L...
2025-06-27 00:04:40,294 - app.services.network_automation - INFO - Added route 0.0.0.0/0 via 10.250.10.1 on SW1 to session.
2025-06-27 00:04:40,294 - app.services.network_automation - INFO - Added route 10.0.1.0/24 via 10.21.0.1 on SW1 to session.
2025-06-27 00:04:40,294 - app.services.network_automation - INFO - Added route 10.0.2.0/24 via 10.21.0.1 on SW1 to session.
2025-06-27 00:04:40,294 - app.services.network_automation - INFO - Added route 10.1.1.0/24 via 10.21.0.1 on SW1 to session.
2025-06-27 00:04:40,294 - app.services.network_automation - INFO - Added route 10.2.1.0/24 via 10.123.0.2 on SW1 to session.
2025-06-27 00:04:40,294 - app.services.network_automation - INFO - Added route 10.3.1.0/24 via 10.31.0.2 on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.11.0.0/30 via 10.21.0.1 on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.12.0.0/30 via 10.21.0.1 on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.21.0.0/30 via None on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.21.0.2/32 via None on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.31.0.0/30 via None on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.31.0.1/32 via None on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.123.0.0/24 via None on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.123.0.1/32 via None on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.250.10.0/24 via None on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Added route 10.250.10.110/32 via None on SW1 to session.
2025-06-27 00:04:40,295 - app.services.network_automation - INFO - Finished adding 16 route entries for SW1.
2025-06-27 00:04:40,299 - app.services.network_automation - INFO - Successfully committed data for device: SW1
2025-06-27 00:04:40,299 - app.services.network_automation - INFO - Attempting to process data for device: R3
2025-06-27 00:04:40,300 - app.services.network_automation - INFO - Added new device 'R3' (ID: 5) to session.
2025-06-27 00:04:40,300 - app.services.network_automation - INFO - Processing interfaces for R3 from /home/firework/firework/app/services/../../outputs/R3_interfaces.yml
2025-06-27 00:04:40,400 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R3_interfaces.yml' size: 1969 bytes.
2025-06-27 00:04:40,401 - app.services.network_automation - DEBUG - Raw content of /home/firework/firework/app/services/../../outputs/R3_interfaces.yml:
ansible_net_all_ipv4_addresses:
- 10.31.0.2
- 10.3.1.254
- 10.250.10.113
ansible_net_all_ipv6_addresses: []
ansible_net_api: cliconf
ansible_net_gather_network_resources: []
ansible_net_gather_subset:
- default
- interfaces
ansible_net_hostname: R3
ansible_net_image: flash0:/vios-adventerprisek9-m
ansible_net_interfaces:
    GigabitEthernet0/0:
        bandwidth: 1000000
        description: '*** SW1 ***'
        duplex: null
        ipv4:
        -   address: 10.31.0.2
            subnet: '30'
...
2025-06-27 00:04:40,403 - app.services.network_automation - DEBUG - Parsed interface data for R3: {
  "ansible_net_all_ipv4_addresses": [
    "10.31.0.2",
    "10.3.1.254",
    "10.250.10.113"
  ],
  "ansible_net_all_ipv6_addresses": [],
  "ansible_net_api": "cliconf",
  "ansible_net_gather_network_resources": [],
  "ansible_net_gather_subset": [
    "default",
    "interfaces"
  ],
  "ansible_net_hostname": "R3",
  "ansible_net_image": "flash0:/vios-adventerprisek9-m",
  "ansible_net_interfaces": {
    "GigabitEthernet0/0": {
      "bandwidth": 1000000,
      "description": "*** SW1 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.31.0.2",
          "subnet": "30"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c42.50d8.0000",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/1": {
      "bandwidth": 1000000,
      "description": "*** D3 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.3.1.254",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c42.50d8.0001",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/2": {
      "bandwidth": 1000000,
      "description": "*** MGMT ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.250.10.113",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c42.50d8.0002",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/3": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": "Auto",
      "ipv4": [],
      "lineprotocol": "down",
      "macaddress": "0c42.50d8.0003",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "administratively down",
      "type": "iGbE"
    }
  },
  "ansible_net_iostype": "IOS",
  "ansible_net_model": "IOSv",
  "ansible_net_neighbors": {
    "GigabitEthernet0/0": [
      {
        "host": "SW1",
        "ip": "10.31.0.1",
        "platform": "Cisco ",
        "port": "GigabitEthernet0/1"
      }
    ]
  },
  "ansible_net_operatingmode": "autonomous",
  "ansible_net_python_version": "3.12.3",
  "ansible_net_serialnum": "9VFHS72IPP3U7AOFQIRA0",
  "ansible_net_system": "ios",
  "ansible_net_version": "15.6(2)T",
  "ansible_network_resources": {}
}
2025-06-27 00:04:40,403 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/0' details for R3. Details: {"bandwidth": 1000000, "description": "*** SW1 ***", "duplex": null, "ipv4": [{"address": "10.31.0.2", "subnet": "30"}], "lineprotocol": "up", "macaddress": "0c42.50d8.0000", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:40,403 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/0: 10.31.0.0/30
2025-06-27 00:04:40,403 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/0' (10.31.0.2) for R3 to session.
2025-06-27 00:04:40,403 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/1' details for R3. Details: {"bandwidth": 1000000, "description": "*** D3 ***", "duplex": null, "ipv4": [{"address": "10.3.1.254", "subnet": "24"}], "lineprotocol": "up", "macaddress": "0c42.50d8.0001", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:40,403 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/1: 10.3.1.0/24
2025-06-27 00:04:40,403 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/1' (10.3.1.254) for R3 to session.
2025-06-27 00:04:40,403 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/2' details for R3. Details: {"bandwidth": 1000000, "description": "*** MGMT ***", "duplex": null, "ipv4": [{"address": "10.250.10.113", "subnet": "24"}], "lineprotocol": "up", "macaddress": "0c42.50d8.0002", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:04:40,403 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/2: 10.250.10.0/24
2025-06-27 00:04:40,403 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/2' (10.250.10.113) for R3 to session.
2025-06-27 00:04:40,403 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/3' details for R3. Details: {"bandwidth": 1000000, "description": null, "duplex": "Auto", "ipv4": [], "lineprotocol": "down", "macaddress": "0c42.50d8.0003", "mediatype": "RJ45", "mtu": 1500, "operstatus": "administratively down", "type": "iGbE"}
2025-06-27 00:04:40,403 - app.services.network_automation - INFO - Finished adding 3 interfaces for R3.
2025-06-27 00:04:40,404 - app.services.network_automation - INFO - Processing ARP for R3 from /home/firework/firework/app/services/../../outputs/R3_arp.txt
2025-06-27 00:04:40,504 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R3_arp.txt' size: 630 bytes.
2025-06-27 00:04:40,504 - app.services.network_automation - DEBUG - Raw ARP data for R3:
Protocol  Address          Age (min)  Hardware Addr   Type   Interface
Internet  10.3.1.254              -   0c42.50d8.0001  ARPA   GigabitEthernet0/1
Internet  10.31.0.1              59   0ca9.e8e5.0001  ARPA   GigabitEthernet0/0
Internet  10.31.0.2               -   0c42.50d8.0000  ARPA   GigabitEthernet0/0
Internet  10.250.10.1           187   000c.2930.4f3a  ARPA   GigabitEthernet0/2
Internet  10.250.10.110           5   0ca9.e8e5.0004  ARPA   GigabitEthernet0/2
Internet  10.250.10.113      ...
2025-06-27 00:04:40,504 - app.services.network_automation - INFO - Added ARP entry 10.3.1.254 (0c4250d80001) on R3 to session.
2025-06-27 00:04:40,504 - app.services.network_automation - INFO - Added ARP entry 10.31.0.1 (0ca9e8e50001) on R3 to session.
2025-06-27 00:04:40,504 - app.services.network_automation - INFO - Added ARP entry 10.31.0.2 (0c4250d80000) on R3 to session.
2025-06-27 00:04:40,504 - app.services.network_automation - INFO - Added ARP entry 10.250.10.1 (000c29304f3a) on R3 to session.
2025-06-27 00:04:40,504 - app.services.network_automation - INFO - Added ARP entry 10.250.10.110 (0ca9e8e50004) on R3 to session.
2025-06-27 00:04:40,504 - app.services.network_automation - INFO - Added ARP entry 10.250.10.113 (0c4250d80002) on R3 to session.
2025-06-27 00:04:40,504 - app.services.network_automation - INFO - Added ARP entry 10.250.10.206 (000c29a0559f) on R3 to session.
2025-06-27 00:04:40,505 - app.services.network_automation - INFO - Finished adding 7 ARP entries for R3.
2025-06-27 00:04:40,505 - app.services.network_automation - INFO - Processing routes for R3 from /home/firework/firework/app/services/../../outputs/R3_routes.txt
2025-06-27 00:04:40,605 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R3_routes.txt' size: 1747 bytes.
2025-06-27 00:04:40,605 - app.services.network_automation - DEBUG - Raw Route data for R3:
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area 
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2
       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
       ia - IS-IS inter area, * - candidate default, U - per-user static route
       o - ODR, P - periodic downloaded static route, H - NHRP, l - L...
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 0.0.0.0/0 via 10.250.10.1 on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.0.1.0/24 via 10.31.0.1 on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.0.2.0/24 via 10.31.0.1 on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.1.1.0/24 via 10.31.0.1 on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.2.1.0/24 via 10.31.0.1 on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.3.1.0/24 via None on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.3.1.254/32 via None on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.11.0.0/30 via 10.31.0.1 on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.12.0.0/30 via 10.31.0.1 on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.21.0.0/30 via 10.31.0.1 on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.31.0.0/30 via None on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.31.0.2/32 via None on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.123.0.0/24 via 10.31.0.1 on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.250.10.0/24 via None on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Added route 10.250.10.113/32 via None on R3 to session.
2025-06-27 00:04:40,606 - app.services.network_automation - INFO - Finished adding 15 route entries for R3.
2025-06-27 00:04:40,611 - app.services.network_automation - INFO - Successfully committed data for device: R3
2025-06-27 00:04:40,611 - app.services.network_automation - INFO - Attempting to process data for device: pafw
2025-06-27 00:04:40,613 - app.services.network_automation - INFO - Added new device 'pafw' (ID: 6) to session.
2025-06-27 00:04:40,613 - app.services.network_automation - INFO - Processing interfaces for pafw from /home/firework/firework/app/services/../../outputs/pafw_interfaces.yml
2025-06-27 00:04:40,713 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/pafw_interfaces.yml' size: 867 bytes.
2025-06-27 00:04:40,714 - app.services.network_automation - DEBUG - Raw content of /home/firework/firework/app/services/../../outputs/pafw_interfaces.yml:
ansible_facts:
    ansible_net_full_commit_required: false
    ansible_net_gather_subset:
    - system
    - interfaces
    ansible_net_hostname: pafw
    ansible_net_interfaces:
    -   comment: null
        ip:
        - 10.11.0.2/30
        ipv6: []
        name: ethernet1/1
    -   comment: null
        ip:
        - 10.12.0.1/30
        ipv6: []
        name: ethernet1/2
    -   comment: null
        ip:
        - 10.1.1.254/24
        ipv6: []
        name: ethernet1/3
    ansible_net_mode...
2025-06-27 00:04:40,716 - app.services.network_automation - DEBUG - Parsed interface data for pafw: {
  "ansible_facts": {
    "ansible_net_full_commit_required": false,
    "ansible_net_gather_subset": [
      "system",
      "interfaces"
    ],
    "ansible_net_hostname": "pafw",
    "ansible_net_interfaces": [
      {
        "comment": null,
        "ip": [
          "10.11.0.2/30"
        ],
        "ipv6": [],
        "name": "ethernet1/1"
      },
      {
        "comment": null,
        "ip": [
          "10.12.0.1/30"
        ],
        "ipv6": [],
        "name": "ethernet1/2"
      },
      {
        "comment": null,
        "ip": [
          "10.1.1.254/24"
        ],
        "ipv6": [],
        "name": "ethernet1/3"
      }
    ],
    "ansible_net_model": "PA-VM",
    "ansible_net_multivsys": "off",
    "ansible_net_serial": "unknown",
    "ansible_net_uncommitted_changes": false,
    "ansible_net_uptime": "0 days, 5:03:48",
    "ansible_net_version": "10.1.0"
  },
  "changed": false,
  "deprecations": [
    {
      "collection_name": "paloaltonetworks.panos",
      "msg": "Classic provider params are deprecated; use \"provider\" instead",
      "version": "4.0.0"
    }
  ],
  "failed": false
}
2025-06-27 00:04:40,716 - app.services.network_automation - DEBUG - Parsing Palo Alto interface 'ethernet1/1' details: {"comment": null, "ip": ["10.11.0.2/30"], "ipv6": [], "name": "ethernet1/1"}
2025-06-27 00:04:40,716 - app.services.network_automation - DEBUG - Constructed CIDR for PA interface ethernet1/1: 10.11.0.0/30
2025-06-27 00:04:40,716 - app.services.network_automation - INFO - Added interface 'ethernet1/1' (10.11.0.2/30) for pafw to session.
2025-06-27 00:04:40,716 - app.services.network_automation - DEBUG - Parsing Palo Alto interface 'ethernet1/2' details: {"comment": null, "ip": ["10.12.0.1/30"], "ipv6": [], "name": "ethernet1/2"}
2025-06-27 00:04:40,716 - app.services.network_automation - DEBUG - Constructed CIDR for PA interface ethernet1/2: 10.12.0.0/30
2025-06-27 00:04:40,716 - app.services.network_automation - INFO - Added interface 'ethernet1/2' (10.12.0.1/30) for pafw to session.
2025-06-27 00:04:40,716 - app.services.network_automation - DEBUG - Parsing Palo Alto interface 'ethernet1/3' details: {"comment": null, "ip": ["10.1.1.254/24"], "ipv6": [], "name": "ethernet1/3"}
2025-06-27 00:04:40,716 - app.services.network_automation - DEBUG - Constructed CIDR for PA interface ethernet1/3: 10.1.1.0/24
2025-06-27 00:04:40,717 - app.services.network_automation - INFO - Added interface 'ethernet1/3' (10.1.1.254/24) for pafw to session.
2025-06-27 00:04:40,717 - app.services.network_automation - INFO - Finished adding 3 interfaces for pafw.
2025-06-27 00:04:40,717 - app.services.network_automation - INFO - Processing ARP for pafw from /home/firework/firework/app/services/../../outputs/pafw_arp.txt
2025-06-27 00:04:40,817 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/pafw_arp.txt' size: 388 bytes.
2025-06-27 00:04:40,817 - app.services.network_automation - DEBUG - Raw ARP data for pafw:
{"response": {"@status": "success", "result": {"max": "250", "total": "2", "timeout": "1800", "dp": "dp0", "entries": {"entry": [{"status": "c", "ip": "10.11.0.1", "mac": "0c:0d:f8:a2:00:00", "ttl": "27", "interface": "ethernet1/1", "port": "ethernet1/1"}, {"status": "c", "ip": "10.12.0.2", "mac": "0c:fa:c9:87:00:00", "ttl": "27", "interface": "ethernet1/2", "port": "ethernet1/2"}]}}}}...
2025-06-27 00:04:40,818 - app.services.network_automation - INFO - Added PA ARP entry 10.11.0.1 (0c:0d:f8:a2:00:00) on pafw to session.
2025-06-27 00:04:40,818 - app.services.network_automation - INFO - Added PA ARP entry 10.12.0.2 (0c:fa:c9:87:00:00) on pafw to session.
2025-06-27 00:04:40,818 - app.services.network_automation - INFO - Finished adding 2 ARP entries for pafw.
2025-06-27 00:04:40,818 - app.services.network_automation - INFO - Processing routes for pafw from /home/firework/firework/app/services/../../outputs/pafw_routes.txt
2025-06-27 00:04:40,918 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/pafw_routes.txt' size: 3397 bytes.
2025-06-27 00:04:40,919 - app.services.network_automation - DEBUG - Raw Route data for pafw:
{"response": {"@status": "success", "result": {"flags": "flags: A:active, ?:loose, C:connect, H:host, S:static, ~:internal, R:rip, O:ospf, B:bgp, Oi:ospf intra-area, Oo:ospf inter-area, O1:ospf ext-type-1, O2:ospf ext-type-2, E:ecmp, M:multicast", "entry": [{"virtual-router": "default", "destination": "10.0.1.0/24", "nexthop": "10.11.0.1", "metric": "11", "flags": "A Oi", "age": "17955", "interface": "ethernet1/1", "route-table": "unicast"}, {"virtual-router": "default", "destination": "10.0.2.0...
2025-06-27 00:04:40,919 - app.services.network_automation - INFO - Added PA route 10.0.1.0/24 via 10.11.0.1 on pafw to session.
2025-06-27 00:04:40,920 - app.services.network_automation - INFO - Added PA route 10.0.2.0/24 via 10.11.0.1 on pafw to session.
2025-06-27 00:04:40,920 - app.services.network_automation - INFO - Added PA route 10.1.1.0/24 via 0.0.0.0 on pafw to session.
2025-06-27 00:04:40,920 - app.services.network_automation - INFO - Added PA route 10.1.1.0/24 via 10.1.1.254 on pafw to session.
2025-06-27 00:04:40,921 - app.services.network_automation - INFO - Added PA route 10.1.1.254/32 via 0.0.0.0 on pafw to session.
2025-06-27 00:04:40,921 - app.services.network_automation - INFO - Added PA route 10.2.1.0/24 via 10.12.0.2 on pafw to session.
2025-06-27 00:04:40,921 - app.services.network_automation - INFO - Added PA route 10.3.1.0/24 via 10.12.0.2 on pafw to session.
2025-06-27 00:04:40,921 - app.services.network_automation - INFO - Added PA route 10.11.0.0/30 via 0.0.0.0 on pafw to session.
2025-06-27 00:04:40,922 - app.services.network_automation - INFO - Added PA route 10.11.0.0/30 via 10.11.0.2 on pafw to session.
2025-06-27 00:04:40,922 - app.services.network_automation - INFO - Added PA route 10.11.0.2/32 via 0.0.0.0 on pafw to session.
2025-06-27 00:04:40,922 - app.services.network_automation - INFO - Added PA route 10.12.0.0/30 via 0.0.0.0 on pafw to session.
2025-06-27 00:04:40,922 - app.services.network_automation - INFO - Added PA route 10.12.0.0/30 via 10.12.0.1 on pafw to session.
2025-06-27 00:04:40,922 - app.services.network_automation - INFO - Added PA route 10.12.0.1/32 via 0.0.0.0 on pafw to session.
2025-06-27 00:04:40,923 - app.services.network_automation - INFO - Added PA route 10.21.0.0/30 via 10.12.0.2 on pafw to session.
2025-06-27 00:04:40,923 - app.services.network_automation - INFO - Added PA route 10.31.0.0/30 via 10.12.0.2 on pafw to session.
2025-06-27 00:04:40,923 - app.services.network_automation - INFO - Added PA route 10.123.0.0/24 via 10.12.0.2 on pafw to session.
2025-06-27 00:04:40,923 - app.services.network_automation - INFO - Added PA route 10.250.10.0/24 via 10.12.0.2 on pafw to session.
2025-06-27 00:04:40,924 - app.services.network_automation - INFO - Finished adding 17 route entries for pafw.
2025-06-27 00:04:40,927 - app.services.network_automation - INFO - Successfully committed data for device: pafw
2025-06-27 00:04:40,927 - app.services.network_automation - INFO - Network topology database build process completed.
2025-06-27 00:04:40,927 - app.services.network_automation - INFO - Performing pathfinding from 10.0.1.1 to 10.3.1.10.
2025-06-27 00:04:40,927 - app.services.network_automation - INFO - Starting pathfinding from 10.0.1.1 to 10.3.1.10 using DB data.
2025-06-27 00:04:40,927 - app.services.network_automation - DEBUG - Attempting to find source device for IP: 10.0.1.1
2025-06-27 00:04:40,929 - app.services.network_automation - DEBUG - Source IP 10.0.1.1 not found directly on an interface. Checking subnets.
2025-06-27 00:04:40,929 - app.services.network_automation - DEBUG - Total interfaces with subnets found in DB: 17
2025-06-27 00:04:40,930 - app.services.network_automation - DEBUG - Checking interface 'GigabitEthernet0/0' (Device ID: 1) on device R1 with subnet '10.11.0.0/30'. Is 10.0.1.1 in 10.11.0.0/30? False
2025-06-27 00:04:40,931 - app.services.network_automation - DEBUG - Checking interface 'GigabitEthernet0/1' (Device ID: 1) on device R1 with subnet '10.0.1.0/24'. Is 10.0.1.1 in 10.0.1.0/24? True
2025-06-27 00:04:40,931 - app.services.network_automation - INFO - Source IP 10.0.1.1 found within subnet 10.0.1.0/24 of interface GigabitEthernet0/1 on device R1.
2025-06-27 00:04:40,931 - app.services.network_automation - DEBUG - Hop 0: Currently on device R1, looking for route to 10.3.1.10.
2025-06-27 00:04:40,933 - app.services.network_automation - DEBUG - Found matching route on R1: 10.3.1.0/24 via 10.11.0.2 on 04:58:46, GigabitEthernet0/0.
2025-06-27 00:04:40,934 - app.services.network_automation - DEBUG - Hop 1: Currently on device pafw, looking for route to 10.3.1.10.
2025-06-27 00:04:40,934 - app.services.network_automation - DEBUG - Found matching route on pafw: 10.3.1.0/24 via 10.12.0.2 on ethernet1/2.
2025-06-27 00:04:40,935 - app.services.network_automation - DEBUG - Hop 2: Currently on device R2, looking for route to 10.3.1.10.
2025-06-27 00:04:40,935 - app.services.network_automation - DEBUG - Found matching route on R2: 10.3.1.0/24 via 10.21.0.2 on 05:01:52, GigabitEthernet0/1.
2025-06-27 00:04:40,936 - app.services.network_automation - DEBUG - Hop 3: Currently on device SW1, looking for route to 10.3.1.10.
2025-06-27 00:04:40,937 - app.services.network_automation - DEBUG - Found matching route on SW1: 10.3.1.0/24 via 10.31.0.2 on 05:01:06, GigabitEthernet0/1.
2025-06-27 00:04:40,937 - app.services.network_automation - DEBUG - Hop 4: Currently on device R3, looking for route to 10.3.1.10.
2025-06-27 00:04:40,938 - app.services.network_automation - DEBUG - Found matching route on R3: 10.3.1.0/24 via direct on is directly connected, GigabitEthernet0/1.
2025-06-27 00:04:40,938 - app.services.network_automation - INFO - Destination IP 10.3.1.10 is directly connected to R3.
2025-06-27 00:04:40,938 - app.services.network_automation - INFO - Pathfinding successfully reached destination 10.3.1.10.
2025-06-27 00:04:40,940 - app.services.network_automation - INFO - Path found. Firewalls in path: ['pafw']
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG - Full path trace: [
  {
    "type": "source_network_entry",
    "ip": "10.0.1.1",
    "device": "R1",
    "interface": "GigabitEthernet0/1",
    "network": "10.0.1.0/24"
  },
  {
    "type": "route_hop",
    "device": "R1",
    "destination_network": "10.3.1.0/24",
    "next_hop": "10.11.0.2",
    "interface": "04:58:46, GigabitEthernet0/0",
    "route_type": "ospf"
  },
  {
    "type": "route_hop",
    "device": "pafw",
    "destination_network": "10.3.1.0/24",
    "next_hop": "10.12.0.2",
    "interface": "ethernet1/2",
    "route_type": "ospf"
  },
  {
    "type": "route_hop",
    "device": "R2",
    "destination_network": "10.3.1.0/24",
    "next_hop": "10.21.0.2",
    "interface": "05:01:52, GigabitEthernet0/1",
    "route_type": "ospf"
  },
  {
    "type": "route_hop",
    "device": "SW1",
    "destination_network": "10.3.1.0/24",
    "next_hop": "10.31.0.2",
    "interface": "05:01:06, GigabitEthernet0/1",
    "route_type": "ospf"
  },
  {
    "type": "route_hop",
    "device": "R3",
    "destination_network": "10.3.1.0/24",
    "next_hop": null,
    "interface": "is directly connected, GigabitEthernet0/1",
    "route_type": "connected"
  }
]
2025-06-27 00:04:40,940 - app.services.network_automation - INFO - Pathfinding completed. Discovered firewalls in path: ['pafw']
2025-06-27 00:04:40,940 - app.services.network_automation - INFO - Pre-checking rule 1 on pafw using pre_check_firewall_rule_paloalto.yml...
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG - --- Subprocess Environment for Ansible ---
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG -   PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG -   USER=firework_app_user
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG -   HOME=/home/firework_app_user
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG -   ANSIBLE_CACHE_DIR=/home/firework/firework/app/services/../../ansible_tmp/cache
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG -   ANSIBLE_TMPDIR=/home/firework/firework/app/services/../../ansible_tmp
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG -   ANSIBLE_HOST_KEY_CHECKING=False
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG -   ANSIBLE_COLLECTIONS_PATH=/home/firework/firework/app/services/../.././ansible_collections
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG -   TMPDIR=/home/firework/firework/app/services/../../ansible_tmp
2025-06-27 00:04:40,940 - app.services.network_automation - DEBUG - ----------------------------------------
2025-06-27 00:04:40,940 - app.services.network_automation - INFO - Executing Ansible command: ansible-playbook /home/firework/firework/app/services/../.././pre_check_firewall_rule_paloalto.yml -i /home/firework/firework/app/services/../../inventory.yml --extra-vars {"firewall_name": "pafw", "source_ip": "10.0.1.1", "destination_ip": "10.3.1.10", "protocol": "tcp", "port": "7071"} in CWD: /home/firework/firework/app/services/../..
2025-06-27 00:04:43,541 - app.services.network_automation - INFO - Ansible playbook 'pre_check_firewall_rule_paloalto.yml' executed successfully.
2025-06-27 00:04:43,542 - app.services.network_automation - INFO - Rule 1 does NOT exist on pafw.
2025-06-27 00:04:43,543 - app.routes - INFO - Pre-check STDOUT for rule 1:

--- pafw STDOUT ---

PLAY [Palo Alto Pre-Check for Existing Firewall Policy] ************************

TASK [Debug Palo Alto Pre-Check variables] *************************************
ok: [pafw] => {
    "msg": "Pre-checking for existing policy on pafw (Palo Alto) for Source: 10.0.1.1, Dest: 10.3.1.10, Proto: tcp, Port: 7071"
}

TASK [Run Palo Alto Security Policy Match] *************************************
changed: [pafw]

TASK [Set policy_found_flag if Palo Alto policy matches] ***********************
skipping: [pafw]

TASK [Indicate if policy was found (Palo Alto)] ********************************
skipping: [pafw]

PLAY RECAP *********************************************************************
pafw                       : ok=2    changed=1    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   


2025-06-27 00:04:43,543 - app.routes - ERROR - Pre-check STDERR for rule 1:

--- pafw STDERR ---
[WARNING]: Found variable using reserved name: port

2025-06-27 00:04:43,545 - app.routes - INFO - Network request ID 1 moved to 'Pending' approval after pre-check.
2025-06-27 00:04:47,840 - app.decorators - WARNING - Self-approval attempt detected for rule ID 1 by user approver2 (ID: 5).
2025-06-27 00:04:56,334 - app.auth_routes - INFO - User approver2 (ID: 5) logged out.
2025-06-27 00:05:03,806 - app.auth_routes - INFO - User approver1 (ID: 4) logged in successfully.
2025-06-27 00:05:13,055 - app.routes - INFO - Rule 1 approved by approver1. Status: Approved - Pending Implementation.
2025-06-27 00:07:08,938 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:07:08,938 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:07:09,287 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:07:09,288 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:07:09,763 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:07:09,763 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:07:13,104 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:07:13,104 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:07:15,302 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:07:15,302 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:07:15,380 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:07:15,380 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:07:15,415 - app - INFO - Database URI configured: postgresql://firework:firework@localhost:5432/fireworkdb
2025-06-27 00:07:15,415 - app - INFO - Current working directory: /home/firework/firework/app
2025-06-27 00:07:27,089 - app.routes - INFO - Received new network request from approver1
2025-06-27 00:07:27,093 - app.routes - INFO - Request from 10.0.1.1 to 10.3.1.10:7072/tcp passed blacklist check for user approver1.
2025-06-27 00:07:27,100 - app.routes - INFO - Network request ID 1 created by approver1 with temporary status 'Pending Pre-Check'.
2025-06-27 00:07:27,100 - app.routes - WARNING - NetworkAutomationService not found on blueprint. Creating a fallback instance.
2025-06-27 00:07:27,100 - app.services.network_automation - INFO - Ansible outputs directory set to: /home/firework/firework/app/services/../../outputs
2025-06-27 00:07:27,100 - app.services.network_automation - INFO - Ansible temporary directory set to: /home/firework/firework/app/services/../../ansible_tmp
2025-06-27 00:07:27,100 - app.services.network_automation - INFO - Performing pre-check for rule 1 on firewalls initially specified: ['pa_firewall_1', 'fgt_firewall_1', 'fgt_firewall_2']
2025-06-27 00:07:27,100 - app.services.network_automation - INFO - Running Ansible network data collector (collector.yml)...
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG - --- Subprocess Environment for Ansible ---
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG -   PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG -   USER=firework_app_user
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG -   HOME=/home/firework_app_user
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG -   ANSIBLE_CACHE_DIR=/home/firework/firework/app/services/../../ansible_tmp/cache
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG -   ANSIBLE_TMPDIR=/home/firework/firework/app/services/../../ansible_tmp
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG -   ANSIBLE_HOST_KEY_CHECKING=False
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG -   ANSIBLE_COLLECTIONS_PATH=/home/firework/firework/app/services/../.././ansible_collections
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG -   TMPDIR=/home/firework/firework/app/services/../../ansible_tmp
2025-06-27 00:07:27,101 - app.services.network_automation - DEBUG - ----------------------------------------
2025-06-27 00:07:27,101 - app.services.network_automation - INFO - Executing Ansible command: ansible-playbook /home/firework/firework/app/services/../.././collector.yml -i /home/firework/firework/app/services/../../inventory.yml in CWD: /home/firework/firework/app/services/../..
2025-06-27 00:07:53,070 - app.services.network_automation - INFO - Ansible playbook 'collector.yml' executed successfully.
2025-06-27 00:07:53,071 - app.services.network_automation - INFO - Network data collection completed.
2025-06-27 00:07:53,071 - app.services.network_automation - INFO - Starting network topology database build process in PostgreSQL.
2025-06-27 00:07:53,071 - app.services.network_automation - INFO - Attempting to list directory: /home/firework/firework/app/services/../../outputs
2025-06-27 00:07:53,071 - app.services.network_automation - INFO - Files found in /home/firework/firework/app/services/../../outputs: ['R1_interfaces.yml', 'R1_routes.txt', 'fgt_arp.yml', 'R2_interfaces.yml', 'R1_arp.txt', 'SW1_interfaces.yml', 'R2_routes.txt', 'SW1_arp.txt', 'fgt_routes.yml', 'R3_routes.txt', 'R2_arp.txt', 'SW1_routes.txt', 'pafw_arp.txt', 'R3_interfaces.yml', 'fgt_interfaces.yml', 'R3_arp.txt', 'pafw_routes.txt', 'pafw_interfaces.yml']
2025-06-27 00:07:53,074 - app.services.network_automation - INFO - Cleared existing network topology data from PostgreSQL.
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: R1_interfaces.yml -> Hostname: R1, Category: interfaces
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: R1_routes.txt -> Hostname: R1, Category: routes
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: fgt_arp.yml -> Hostname: fgt, Category: arp
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: R2_interfaces.yml -> Hostname: R2, Category: interfaces
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: R1_arp.txt -> Hostname: R1, Category: arp
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: SW1_interfaces.yml -> Hostname: SW1, Category: interfaces
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: R2_routes.txt -> Hostname: R2, Category: routes
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: SW1_arp.txt -> Hostname: SW1, Category: arp
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: fgt_routes.yml -> Hostname: fgt, Category: routes
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: R3_routes.txt -> Hostname: R3, Category: routes
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: R2_arp.txt -> Hostname: R2, Category: arp
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: SW1_routes.txt -> Hostname: SW1, Category: routes
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: pafw_arp.txt -> Hostname: pafw, Category: arp
2025-06-27 00:07:53,074 - app.services.network_automation - DEBUG - Identified file: R3_interfaces.yml -> Hostname: R3, Category: interfaces
2025-06-27 00:07:53,075 - app.services.network_automation - DEBUG - Identified file: fgt_interfaces.yml -> Hostname: fgt, Category: interfaces
2025-06-27 00:07:53,075 - app.services.network_automation - DEBUG - Identified file: R3_arp.txt -> Hostname: R3, Category: arp
2025-06-27 00:07:53,075 - app.services.network_automation - DEBUG - Identified file: pafw_routes.txt -> Hostname: pafw, Category: routes
2025-06-27 00:07:53,075 - app.services.network_automation - DEBUG - Identified file: pafw_interfaces.yml -> Hostname: pafw, Category: interfaces
2025-06-27 00:07:53,075 - app.services.network_automation - INFO - Discovered device files for processing: {
  "R1": {
    "type": "Router",
    "interfaces": "/home/firework/firework/app/services/../../outputs/R1_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/R1_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/R1_routes.txt"
  },
  "fgt": {
    "type": "Firewall",
    "interfaces": "/home/firework/firework/app/services/../../outputs/fgt_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/fgt_arp.yml",
    "routes": "/home/firework/firework/app/services/../../outputs/fgt_routes.yml"
  },
  "R2": {
    "type": "Router",
    "interfaces": "/home/firework/firework/app/services/../../outputs/R2_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/R2_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/R2_routes.txt"
  },
  "SW1": {
    "type": "Switch",
    "interfaces": "/home/firework/firework/app/services/../../outputs/SW1_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/SW1_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/SW1_routes.txt"
  },
  "R3": {
    "type": "Router",
    "interfaces": "/home/firework/firework/app/services/../../outputs/R3_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/R3_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/R3_routes.txt"
  },
  "pafw": {
    "type": "Firewall",
    "interfaces": "/home/firework/firework/app/services/../../outputs/pafw_interfaces.yml",
    "arp": "/home/firework/firework/app/services/../../outputs/pafw_arp.txt",
    "routes": "/home/firework/firework/app/services/../../outputs/pafw_routes.txt"
  }
}
2025-06-27 00:07:53,075 - app.services.network_automation - INFO - Attempting to process data for device: R1
2025-06-27 00:07:53,077 - app.services.network_automation - INFO - Added new device 'R1' (ID: 1) to session.
2025-06-27 00:07:53,077 - app.services.network_automation - INFO - Processing interfaces for R1 from /home/firework/firework/app/services/../../outputs/R1_interfaces.yml
2025-06-27 00:07:53,178 - app.services.network_automation - DEBUG - File '/home/firework/firework/app/services/../../outputs/R1_interfaces.yml' size: 2123 bytes.
2025-06-27 00:07:53,178 - app.services.network_automation - DEBUG - Raw content of /home/firework/firework/app/services/../../outputs/R1_interfaces.yml:
ansible_net_all_ipv4_addresses:
- 10.11.0.1
- 10.0.1.254
- 10.0.2.254
- 10.250.10.111
ansible_net_all_ipv6_addresses: []
ansible_net_api: cliconf
ansible_net_gather_network_resources: []
ansible_net_gather_subset:
- interfaces
- default
ansible_net_hostname: R1
ansible_net_image: flash0:/vios-adventerprisek9-m
ansible_net_interfaces:
    GigabitEthernet0/0:
        bandwidth: 1000000
        description: '*** pafw ***'
        duplex: null
        ipv4:
        -   address: 10.11.0.1
           ...
2025-06-27 00:07:53,184 - app.services.network_automation - DEBUG - Parsed interface data for R1: {
  "ansible_net_all_ipv4_addresses": [
    "10.11.0.1",
    "10.0.1.254",
    "10.0.2.254",
    "10.250.10.111"
  ],
  "ansible_net_all_ipv6_addresses": [],
  "ansible_net_api": "cliconf",
  "ansible_net_gather_network_resources": [],
  "ansible_net_gather_subset": [
    "interfaces",
    "default"
  ],
  "ansible_net_hostname": "R1",
  "ansible_net_image": "flash0:/vios-adventerprisek9-m",
  "ansible_net_interfaces": {
    "GigabitEthernet0/0": {
      "bandwidth": 1000000,
      "description": "*** pafw ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.11.0.1",
          "subnet": "30"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c0d.f8a2.0000",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/1": {
      "bandwidth": 1000000,
      "description": "*** s0 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.0.1.254",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c0d.f8a2.0001",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/2": {
      "bandwidth": 1000000,
      "description": "*** d0 ***",
      "duplex": null,
      "ipv4": [
        {
          "address": "10.0.2.254",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c0d.f8a2.0002",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "GigabitEthernet0/3": {
      "bandwidth": 1000000,
      "description": null,
      "duplex": null,
      "ipv4": [
        {
          "address": "10.250.10.111",
          "subnet": "24"
        }
      ],
      "lineprotocol": "up",
      "macaddress": "0c0d.f8a2.0003",
      "mediatype": "RJ45",
      "mtu": 1500,
      "operstatus": "up",
      "type": "iGbE"
    },
    "NVI0": {
      "bandwidth": 56,
      "description": null,
      "duplex": null,
      "ipv4": [],
      "lineprotocol": "up",
      "macaddress": null,
      "mediatype": null,
      "mtu": 1514,
      "operstatus": "up",
      "type": null
    }
  },
  "ansible_net_iostype": "IOS",
  "ansible_net_model": "IOSv",
  "ansible_net_neighbors": {},
  "ansible_net_operatingmode": "autonomous",
  "ansible_net_python_version": "3.12.3",
  "ansible_net_serialnum": "9MQLLMAY42N2TTAMWTLXE",
  "ansible_net_system": "ios",
  "ansible_net_version": "15.6(2)T",
  "ansible_network_resources": {}
}
2025-06-27 00:07:53,185 - app.services.network_automation - DEBUG - Parsing interface 'GigabitEthernet0/0' details for R1. Details: {"bandwidth": 1000000, "description": "*** pafw ***", "duplex": null, "ipv4": [{"address": "10.11.0.1", "subnet": "30"}], "lineprotocol": "up", "macaddress": "0c0d.f8a2.0000", "mediatype": "RJ45", "mtu": 1500, "operstatus": "up", "type": "iGbE"}
2025-06-27 00:07:53,185 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/0: 10.11.0.0/30
2025-06-27 00:07:53,185 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/0' (10.11.0.1) for R1 to session.
2025-06-27 00:07:53,187 - app.services.network_automation - DEBUG - Constructed CIDR for GigabitEthernet0/1: 10.0.1.0/24
2025-06-27 00:07:53,187 - app.services.network_automation - INFO - Added interface 'GigabitEthernet0/1' (10.0.1.254) for R1 to session.
